<div
  class="w-full max-w-sm mx-auto px-4 py-6 sm:max-w-md sm:px-6 sm:py-8 md:max-w-lg lg:max-w-xl xl:max-w-2xl"
>
  <div
    class="bg-surface border border-border rounded-lg p-6 shadow-sm sm:rounded-xl sm:p-8 md:shadow-lg"
  >
    <div class="text-center mb-6 sm:mb-8">
      <div class="flex justify-center mb-4">
        <div class="bg-primary/10 p-3 rounded-full">
          <img
            [ngSrc]="'/icons/edit_square.svg'"
            alt="lock"
            class="w-6 h-6 object-contain icon-invert sm:w-7 sm:h-7 icon-invert"
            width="24"
            height="24"
          />
        </div>
      </div>
      <h2 class="text-2xl font-bold text-text sm:text-3xl md:text-4xl">
        Mot de passe oublié ?
      </h2>
      <p class="text-muted mt-2 text-sm sm:text-base sm:mt-4">
        Entrez votre adresse email et nous vous enverrons un lien pour réinitialiser votre mot
        de passe.
      </p>
    </div>

    @if (!emailSent()) {
      <form
        [formGroup]="forgotPasswordForm"
        (ngSubmit)="onSubmit()"
        class="space-y-4 sm:space-y-6"
      >
        <div class="space-y-1 sm:space-y-2">
          <label for="email" class="block text-sm font-medium text-text sm:text-base">
            Adresse email
          </label>
          <input
            id="email"
            type="email"
            formControlName="email"
            class="w-full px-3 py-2 border rounded-md bg-background text-text placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-200 sm:px-4 sm:py-3 sm:rounded-lg"
            [class.border-error]="isFieldInvalid('email')"
            [class.border-input]="!isFieldInvalid('email')"
            placeholder="votre@email.com"
          />
          @if (isFieldInvalid('email')) {
            <p class="text-error text-xs mt-1 sm:text-sm">
              @if (forgotPasswordForm.get('email')?.errors?.['required']) {
                L'email est requis
              } @else if (forgotPasswordForm.get('email')?.errors?.['email']) {
                Veuillez entrer un email valide
              }
            </p>
          }
        </div>

        <app-button
          type="submit"
          color="primary"
          [disabled]="forgotPasswordForm.invalid"
          [isLoading]="authService.isLoading()"
          customClass="w-full py-3 text-base font-semibold mt-6 sm:py-4 sm:text-lg sm:mt-8"
        >
          @if (authService.isLoading()) {
            Envoi en cours...
          } @else {
            Envoyer le lien de réinitialisation
          }
        </app-button>
      </form>
    } @else {
      <div class="text-center space-y-4">
        <div class="bg-success/10 border border-success/20 rounded-lg p-4">
          <div class="flex justify-center mb-3">
            <div class="bg-success/20 p-2 rounded-full">
              <img
                [ngSrc]="'/icons/check.svg'"
                alt="check"
                class="w-5 h-5 object-contain icon-invert sm:w-6 sm:h-6 icon-invert"
                width="20"
                height="20"
              />
            </div>
          </div>
          <h3 class="font-semibold text-success mb-2">Email envoyé !</h3>
          <p class="text-success/80 text-sm">
            Si un compte existe avec cette adresse email, vous recevrez un lien de
            réinitialisation dans quelques minutes.
          </p>
        </div>

        <button
          type="button"
          (click)="resetForm()"
          class="text-primary hover:text-primary-600 font-medium text-sm transition-colors duration-200 underline-offset-4 hover:underline"
        >
          Envoyer à nouveau
        </button>
      </div>
    }

    <div class="mt-6 text-center sm:mt-8">
      <button
        type="button"
        (click)="navigateToSignin()"
        class="text-muted hover:text-text font-medium text-sm transition-colors duration-200 underline-offset-4 hover:underline flex items-center justify-center gap-2"
      >
        <img
          [ngSrc]="'/icons/arrow-left.svg'"
          alt="retour"
          class="w-4 h-4 object-contain icon-invert sm:w-5 sm:h-5 icon-invert"
          width="16"
          height="16"
        />
        Retour à la connexion
      </button>
    </div>
  </div>
</div>